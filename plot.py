import numpy as np
import matplotlib.pyplot as plt
from scipy.ndimage.filters import gaussian_filter1d
epsilons = [0, 0.1, 0.3, 0.5, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0, 1.3, 1.5, 1.7, 2.0] # linear loss
# epsilons = [0, 1., 3., 4., 6., 8., 10., 12.] # poisson
# epsilons = [0, 1., 3., 4., 7., 8., 10., 12.] # poisson alt
# epsilons = [0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.5, 2.0, 2.5, 3.0] # gaussian
# epsilons = [0, 0.1, 0.2, 0.3, 0.7, 0.8, 0.9, 1.0, 1.5, 2.0] # gaussian reduced
# epsilons = [0, 0.4, 0.6, 0.8, 1.1, 1.3, 1.5, 2.0, 2.5, 3.0, 5.0, 7.0, 9.0, 12.0, 15.0] # rbf
# epsilons = [0, 0.1, 0.5, 1.0, 1.5, 2.0, 3.0, 4.0, 5.0, 7.0, 10.0]

test_losses = [[-3.55613327,-5.19867194,-6.01476545,-6.68466661,-7.419834,-7.75418943
,-8.06065017,-8.32250401,-8.55188763,-8.70063074,-8.88770274,-9.28455815
,-9.20204968,-9.30456615,-9.37101984,-9.5194302,-9.50022762,-9.47747797
,-9.55827712,-9.60726148,-9.66988927,-9.71504512,-9.63546371,-9.72319242
,-9.7737293,-9.78164329,-9.77771859,-9.79523395,-9.79198853,-9.82355094
,-9.83557034,-9.79064108,-9.85536623,-9.8106649,-9.85794459,-9.86465401
,-9.86551585,-9.87163353,-9.85994817,-9.87168409]
,[-3.75966813,-4.79090462,-5.99998289,-6.59344894,-7.38774107,-7.70099506
,-8.13173797,-8.28053101,-8.59604226,-8.77378965,-8.89318077,-9.10639576
,-9.091037,-9.34149296,-9.38657516,-9.38119166,-9.35611389,-9.59453484
,-9.54825898,-9.65678698,-9.70555196,-9.7379703,-9.70345406,-9.64804576
,-9.72863291,-9.77511468,-9.83605702,-9.80873244,-9.82788718,-9.84321076
,-9.817841,-9.83636781,-9.86290004,-9.85031388,-9.83722725,-9.85401573
,-9.86900539,-9.83944516,-9.86313126,-9.85921776]
,[-3.65789907,-4.78276413,-6.18100968,-6.77210161,-7.14689689,-7.64900432
,-8.12690618,-8.13203329,-8.5222368,-8.71300559,-8.8916728,-8.98654204
,-9.1583861,-9.21956144,-9.23866625,-9.40270188,-9.51566152,-9.48192545
,-9.51535943,-9.56864155,-9.60084545,-9.76308977,-9.70087358,-9.71980354
,-9.71920144,-9.76428406,-9.7639968,-9.75437394,-9.78381308,-9.79228155
,-9.79963125,-9.82558476,-9.84149263,-9.84098027,-9.83829477,-9.85361907
,-9.85206914,-9.85851433,-9.83160323,-9.8576383,]
,[-3.46881332,-4.9339234,-5.99143634,-6.29577742,-7.05287362,-7.63561009
,-7.87090445,-8.29822682,-8.40924849,-8.71002651,-8.79319856,-8.95387112
,-9.10415912,-9.14024908,-9.29861616,-9.29190855,-9.45441364,-9.42076533
,-9.52602153,-9.59466961,-9.53196706,-9.6474364,-9.64937938,-9.66949247
,-9.72957421,-9.72996152,-9.73122684,-9.78994145,-9.79754201,-9.803233
,-9.79268924,-9.79940193,-9.82618708,-9.83349308,-9.83632871,-9.845493
,-9.84362291,-9.84874875,-9.87206054,-9.8541346,]
,[-3.46496281,-4.98359741,-5.97554439,-6.65749104,-6.95727216,-7.46023013
,-7.75543533,-8.23683508,-8.36976972,-8.6125984,-8.73621087,-8.88905984
,-8.97635251,-9.13717562,-9.25027249,-9.31413267,-9.40077321,-9.42166692
,-9.41181355,-9.5447082,-9.55327872,-9.61573072,-9.65658701,-9.62850878
,-9.66987799,-9.73382131,-9.75297512,-9.76401254,-9.75763341,-9.77827368
,-9.78471334,-9.79598114,-9.80946643,-9.84743261,-9.85693148,-9.84814079
,-9.84681308,-9.87708546,-9.86601263,-9.87095985]
,[-3.85415486,-4.88773359,-5.70439082,-6.61981782,-6.96429557,-7.43913719
,-7.88075301,-8.01401234,-8.34897253,-8.50385596,-8.74208567,-8.84056483
,-8.90744417,-9.07687021,-9.21703652,-9.30365006,-9.30546198,-9.46200702
,-9.42960597,-9.5532972,-9.49849884,-9.53908363,-9.64940878,-9.63446043
,-9.68151146,-9.67828036,-9.71037372,-9.77143283,-9.77857998,-9.77271787
,-9.82324855,-9.80288979,-9.80327899,-9.83259424,-9.82195991,-9.83305546
,-9.78491091,-9.83662967,-9.84263469,-9.86217242]
,[-3.5275345,-4.82834126,-5.77594507,-6.46992611,-7.10247902,-7.3641164
,-7.74510071,-8.1706722,-8.19990366,-8.51580014,-8.72638185,-8.80784821
,-8.934484,-9.15289496,-9.15198599,-9.27702835,-9.32637043,-9.3395182
,-9.43966392,-9.44874643,-9.53189496,-9.55700102,-9.5867442,-9.62278924
,-9.68360843,-9.72919381,-9.70730242,-9.77423472,-9.79005924,-9.80719332
,-9.83608884,-9.82246067,-9.80355409,-9.83093696,-9.82664996,-9.81598741
,-9.81558436,-9.83452208,-9.84890824,-9.81956366]
,[-3.79718059,-4.96672084,-5.70215986,-6.5804269,-6.93812634,-7.25387305
,-7.84535659,-8.09044063,-8.23807334,-8.59082603,-8.6434798,-8.77008642
,-8.94729541,-9.0916603,-9.10837298,-9.11238214,-9.3141648,-9.33221283
,-9.42162007,-9.46642549,-9.48577802,-9.50829945,-9.64506682,-9.66227637
,-9.65039193,-9.70936429,-9.77177498,-9.7538922,-9.81756036,-9.84198839
,-9.80255088,-9.82049692,-9.7780019,-9.80992344,-9.78550257,-9.81359204
,-9.80711673,-9.79383015,-9.81779989,-9.81917443]
,[-3.33895489,-4.84861016,-5.86245745,-6.39834548,-7.0887479,-7.37826801
,-7.6679792,-7.96939524,-8.28135066,-8.40632983,-8.55536084,-8.71021866
,-8.929764,-9.0929437,-9.16185661,-9.15174331,-9.20636336,-9.34650895
,-9.36212611,-9.46227105,-9.51987422,-9.52352127,-9.55129036,-9.66718477
,-9.72499445,-9.75777099,-9.7849781,-9.74911645,-9.7649675,-9.74382248
,-9.73823026,-9.69991663,-9.78323548,-9.77215864,-9.74366299,-9.73040282
,-9.77551607,-9.72953879,-9.7852335,-9.80896155]
,[-3.84927229,-4.62575013,-5.71050648,-6.33834131,-6.98554623,-7.41206759
,-7.66457882,-8.11504607,-8.30581366,-8.46293999,-8.56871701,-8.81007757
,-8.89533048,-8.96892183,-9.02937786,-9.13582133,-9.2298421,-9.30549926
,-9.35307885,-9.35075935,-9.46990104,-9.56402262,-9.64047293,-9.65097868
,-9.699037,-9.69316777,-9.68209561,-9.73272386,-9.73250508,-9.75923306
,-9.71334835,-9.68083012,-9.71676967,-9.7331251,-9.7081833,-9.72596746
,-9.67787769,-9.76825017,-9.78265247,-9.77303889]
,[-3.50074022,-4.84159357,-5.33496817,-6.36735604,-6.88651276,-7.39581953
,-7.70181189,-7.95005159,-8.10703046,-8.41981181,-8.51406211,-8.64900526
,-8.77087544,-8.90974144,-9.01684967,-9.11252555,-9.17049192,-9.27810378
,-9.27585027,-9.39677251,-9.44170158,-9.5626847,-9.66241901,-9.60916394
,-9.65108383,-9.57265129,-9.67168268,-9.59497776,-9.64185276,-9.65537549
,-9.69977876,-9.66264032,-9.69311101,-9.66393726,-9.6633796,-9.69216735
,-9.62860212,-9.62572041,-9.734984,-9.71568507]
,[-3.46479355,-4.77959479,-5.74372863,-6.35847116,-6.80358767,-7.29518521
,-7.51274777,-7.67877117,-8.23204985,-8.26371653,-8.50792889,-8.66286659
,-8.76063,-8.86824653,-8.95079729,-9.05401453,-9.13403802,-9.26501276
,-9.17638741,-9.34683746,-9.3514381,-9.53059063,-9.46641932,-9.54228079
,-9.53539087,-9.59634669,-9.47627861,-9.50082893,-9.55599137,-9.53393084
,-9.58943029,-9.62160605,-9.66670297,-9.66689313,-9.64220338,-9.59483096
,-9.6155009,-9.56601421,-9.59845526,-9.63361345]
,[-3.59070024,-4.64923262,-5.55280637,-6.27721698,-6.84414459,-7.26066419
,-7.5627752,-7.84698108,-8.14798731,-8.16407854,-8.4642103,-8.62907402
,-8.75625026,-8.82050737,-8.92107878,-9.00672098,-9.03034946,-9.00981475
,-9.21285366,-9.29283073,-9.38836127,-9.36619921,-9.37283601,-9.49789106
,-9.46589186,-9.40352408,-9.51949374,-9.46072475,-9.43008144,-9.44959825
,-9.48757428,-9.51703602,-9.47797418,-9.51987484,-9.56698018,-9.53135055
,-9.56704395,-9.56187404,-9.46204103,-9.49547419]
,[-3.78026382,-4.69837105,-5.42644675,-5.996924,-6.43154563,-6.92441014
,-7.06817312,-7.42218427,-7.47524301,-7.51806152,-7.62748082,-7.92478481
,-8.0731612,-8.04236118,-8.2000177,-8.19063701,-8.04650395,-7.97314875
,-8.24026857,-8.2660634,-8.20668587,-8.33747563,-8.30078367,-8.10320153
,-8.13851048,-8.28981122,-8.20090258,-8.24274654,-8.30818945,-8.2721372
,-8.21916167,-8.27283653,-8.39596297,-8.29277252,-8.21081992,-8.55142421
,-8.40646544,-8.6566109,-8.28514083,-8.59658933]
,[-3.3565292,-4.4693161,-5.13381712,-5.95792444,-6.34378631,-6.47122769
,-6.70071429,-6.72325891,-6.7953954,-6.85941486,-7.14868324,-7.0877666
,-7.18274484,-7.40689171,-7.20029655,-7.23682342,-7.16915089,-7.15466614
,-7.4645871,-7.26531358,-7.4219966,-7.51545528,-7.48126776,-7.38529045
,-7.52228721,-7.61899781,-7.49693896,-7.46616474,-7.34373501,-7.64351212
,-7.36838201,-7.49281056,-7.56193759,-7.52821528,-7.68246828,-7.48449696
,-7.49043988,-7.47343645,-7.45127704,-7.38323843]
,[-3.1460298,-4.35871044,-5.09674952,-5.32132031,-5.71324407,-5.95882995
,-5.95737762,-6.45570683,-6.4256857,-6.3069952,-6.56198457,-6.67628121
,-6.46187166,-6.68635525,-6.71087033,-6.73900561,-6.7584516,-6.64285712
,-6.76258188,-6.73528238,-6.6590576,-6.87535337,-6.80320748,-6.71452784
,-6.66359525,-6.6086352,-7.08470732,-6.77823744,-6.71405141,-6.78728216
,-6.88101137,-6.82959132,-6.90011099,-6.85917563,-6.54920728,-6.70827342
,-6.77103995,-6.63589194,-6.85994334,-6.77809674]
,[-2.91783692,-4.1111926,-4.63696502,-4.68819667,-5.30533523,-5.48783948
,-5.64895936,-5.76512722,-5.82816509,-5.61871586,-5.9935167,-5.81869718
,-5.84075464,-5.72660777,-5.96085726,-5.85103474,-5.84416902,-5.8267451
,-5.77721437,-5.86292495,-5.87560483,-5.97793366,-5.89570258,-5.9356922
,-5.95873788,-5.95699482,-5.8212971,-5.71224388,-5.90275638,-5.56582688
,-5.99019207,-5.85866424,-5.94161194,-5.95321479,-5.57962055,-5.91718448
,-5.80341095,-5.77863474,-5.85066127,-5.93488162]]



if len(epsilons) != len(test_losses):
    print(len(epsilons), len(test_losses))
    raise Exception("should be the same, check epsilons")
TRAIN_SIZE = len(test_losses[0])
train_sizes = np.arange(2, TRAIN_SIZE+1)

plt.title("Linear 10D with FGM sqrt")
plt.xlabel("Size of Training Dataset")
plt.ylabel("Test Loss")
for i in range(len(epsilons)):
    print('eps:', epsilons[i])
    ysmoothed = gaussian_filter1d(test_losses[i][1:], sigma=1)
    plt.plot(train_sizes, ysmoothed, label=f"Ɛ = {epsilons[i]}")
plt.legend(loc="right")
plt.savefig(f"linear_fgm_sqrt_10d.png")
plt.clf()

"""
# 1
plt.title("Linear Regression Gaussian")
plt.xlabel("Size of Training Dataset")
plt.ylabel("Test Loss")
for i in [1,2,3]: # range(len(epsilons)):
    print('eps:', epsilons[i])
    plt.plot(train_sizes, test_losses[i], label=f"Ɛ = {epsilons[i]}")
plt.legend(loc="best")
plt.savefig(f"linreg_gaussian_fgsm_1d_weak.png")
plt.clf()

# 2
for i in [13, 14, 15, 16]:
    print('eps:', epsilons[i])
    plt.plot(train_sizes, test_losses[i], label=f"Ɛ = {epsilons[i]}")
plt.legend(loc="best")
plt.savefig(f"linreg_gaussian_fgsm_1d_strong.png")
"""
