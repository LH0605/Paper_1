import numpy as np
import matplotlib.pyplot as plt
from scipy.ndimage.filters import gaussian_filter1d
epsilons = [0, 0.1, 0.3, 0.5, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0, 1.3, 1.5, 1.7, 2.0] # linear loss
# epsilons = [0, 1., 3., 4., 6., 8., 10., 12.] # poisson
# epsilons = [0, 1., 2., 3., 4., 5., 6., 8., 10., 12.]
# epsilons = [0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.5, 2.0, 2.5, 3.0] # gaussian
# epsilons = [0, 0.1, 0.2, 0.3, 0.7, 0.8, 0.9, 1.0, 1.5, 2.0] # gaussian

test_losses = [[-0.32072777,-0.56639159,-0.60051157,-0.70969549,-0.76428745,-0.8325274
,-0.82570341,-0.82570341,-0.87347137,-0.86664738,-0.93488733,-0.94171133
,-0.9758313,-0.9758313,-0.94171133,-0.98947929,-0.99630329,-0.98947929
,-0.9826553,-0.9826553,-0.99630329,-1.00995128,-1.00312728,-0.99630329
,-1.00995128,-0.99630329,-1.02359927,-1.01677527,-1.01677527,-1.02359927
,-1.02359927,-1.00995128,-1.01677527,-1.02359927,-1.01677527,-1.01677527
,-1.02359927,-1.02359927,-1.02359927,-1.02359927]
,[-0.34710442,-0.45001324,-0.58737664,-0.75941473,-0.73389039,-0.79759694
,-0.84335069,-0.83135125,-0.90692733,-0.90055821,-0.92108474,-0.95183846
,-0.96526596,-0.96288175,-0.97577918,-0.96888363,-0.97059772,-1.00312728
,-1.00312728,-0.98610388,-1.00312728,-1.00312728,-0.99619686,-1.01984749
,-1.01677527,-1.00610304,-1.00995128,-1.00995128,-1.02359927,-1.01677527
,-1.02359927,-1.02071186,-1.02359927,-1.01677527,-1.02359927,-1.02359927
,-1.02359927,-1.02359927,-1.02322964,-1.02359927]
,[-0.50400114,-0.58680313,-0.64237503,-0.63847227,-0.75833709,-0.7949127
,-0.82974073,-0.8698932,-0.8471287,-0.92710782,-0.92628616,-0.95492807
,-0.92143284,-0.91472381,-0.97100847,-0.97942862,-0.96916104,-0.99258774
,-1.00666223,-0.99727469,-1.00995128,-0.9871128,-0.97933471,-0.99980445
,-1.01973606,-1.01677527,-1.00836578,-1.01332294,-1.01894737,-1.02085041
,-1.01030145,-1.02359927,-1.02359927,-1.02359927,-1.02359927,-1.02114477
,-1.01983231,-1.02359927,-1.01677527,-1.02359927]
,[-0.3393665,-0.59510905,-0.60276128,-0.75699624,-0.73285117,-0.73646708
,-0.82958073,-0.81461394,-0.89684125,-0.91335641,-0.91150351,-0.96565391
,-0.97569338,-0.96659675,-0.94760874,-0.94082431,-0.95773328,-0.97981562
,-0.98188376,-0.99070745,-0.9981843,-0.99677181,-1.01593685,-0.98981911
,-1.0105355,-1.02359927,-1.01677527,-1.0157785,-1.01356596,-1.01690568
,-1.01369646,-1.01597998,-1.01720359,-1.02359927,-1.02047581,-1.02359927
,-1.01737706,-1.01962072,-1.01633867,-1.02359927]
,[-0.36678905,-0.55628617,-0.58680702,-0.60334595,-0.7073726,-0.76362943
,-0.83187185,-0.8212228,-0.83234685,-0.91580745,-0.8877295,-0.95533046
,-0.93909346,-0.93761152,-0.96866912,-0.97154858,-0.97916263,-0.9855679
,-0.98142238,-1.00367231,-1.00022334,-0.98505027,-0.98986335,-1.00307819
,-1.00741277,-1.00673054,-1.01461803,-1.02016327,-1.01764421,-1.01765003
,-0.99723003,-1.0172588,-1.01765555,-1.0201903,-1.01328505,-1.01656734
,-1.01722605,-1.02359927,-1.02034356,-1.02359927]
,[-0.36754773,-0.52205131,-0.59783661,-0.68875707,-0.6886942,-0.8100322
,-0.84150733,-0.8216636,-0.91050072,-0.85134357,-0.95057673,-0.91832223
,-0.89249933,-0.9434359,-0.95846958,-0.95975842,-0.9753292,-0.96661956
,-0.96611646,-0.98888228,-1.00519382,-1.00145584,-1.02025298,-1.00755801
,-1.01007213,-1.00826776,-1.02050372,-1.01605535,-1.01798956,-1.00533804
,-1.0207625,-1.02359927,-1.02065258,-1.02292436,-1.01724366,-1.01568353
,-1.01985042,-1.0217732,-1.02060268,-1.01353445]
,[-0.44936136,-0.47083851,-0.61207448,-0.64343637,-0.69988034,-0.74308907
,-0.77510354,-0.86390442,-0.86135571,-0.90067814,-0.92933458,-0.91664574
,-0.98378987,-0.95842841,-0.98406551,-0.97676184,-0.95888022,-0.97234256
,-1.00524302,-0.95942819,-0.99980222,-0.99923374,-1.01832739,-0.99835499
,-0.99831934,-1.01721803,-0.99314235,-0.99969966,-1.01315346,-1.01035494
,-1.0117568,-1.02156223,-1.01502657,-1.0201737,-1.0100252,-1.02359927
,-1.02359927,-1.02098831,-1.02060404,-1.01508168]
,[-0.35000003,-0.53684858,-0.64606943,-0.67798966,-0.74889981,-0.7370177
,-0.8222775,-0.88072496,-0.87437914,-0.89285358,-0.90257818,-0.921192
,-0.90012928,-0.93686004,-0.93544437,-0.97096469,-0.99407978,-0.97474467
,-0.9819323,-0.99492284,-1.00249947,-0.97451059,-0.99993508,-1.00683376
,-1.01698576,-1.0201194,-1.01398958,-1.01706479,-0.99611088,-1.02068872
,-1.01690565,-1.0137856,-1.02359927,-1.02359927,-1.0172498,-1.02012634
,-1.02011737,-1.02359927,-1.02359927,-1.02359927]
,[-0.34449807,-0.50427007,-0.64802263,-0.63122463,-0.64012295,-0.74842872
,-0.83030804,-0.86601543,-0.86254643,-0.86130266,-0.90480239,-0.94637914
,-0.87672931,-0.92730345,-0.96400215,-0.95166086,-0.95351214,-0.98698452
,-0.96054489,-0.97781745,-0.98000779,-1.0029979,-1.00280129,-0.99707316
,-1.00171911,-0.98963786,-1.02359927,-1.0099789,-1.0133566,-1.01444008
,-1.01978847,-1.02359927,-1.02015613,-1.01430921,-1.02049485,-1.02359927
,-1.02018094,-1.01510791,-1.02056629,-1.02359927]
,[-0.29245262,-0.51960256,-0.56700313,-0.6898148,-0.74546313,-0.69321267
,-0.78667332,-0.8025613,-0.84180166,-0.92238436,-0.87338047,-0.9570793
,-0.91103089,-0.91491934,-0.95636638,-0.97503984,-0.97465317,-0.94238592
,-0.98264685,-0.99679707,-1.00241902,-1.00321471,-0.99963047,-1.00420449
,-1.0181165,-1.00631197,-1.01345948,-1.01931187,-1.00355482,-1.01565584
,-1.01087605,-1.0147638,-1.02359927,-1.02359927,-1.01825665,-1.01418935
,-1.02359927,-1.00954996,-1.01608531,-1.02359927]
,[-0.3400134,-0.55237701,-0.54820019,-0.65732309,-0.72247854,-0.75069725
,-0.78368827,-0.80901554,-0.82459531,-0.85973979,-0.87949576,-0.89358159
,-0.91852443,-0.94020388,-0.96295839,-0.95075964,-0.97077903,-0.97136576
,-0.97627792,-1.00359875,-1.00113256,-0.99114729,-1.00422294,-1.0068302
,-1.01378392,-1.01285196,-0.99934217,-1.01713339,-1.02019321,-1.01016084
,-1.01091824,-1.01048384,-1.01744679,-1.01865748,-1.01823782,-1.02017408
,-1.02075464,-1.01677527,-1.01718211,-1.02049561]
,[-0.38203578,-0.4965139,-0.58377907,-0.68701235,-0.71432508,-0.78380873
,-0.83520415,-0.87294269,-0.86487813,-0.85843819,-0.88426278,-0.94048326
,-0.92851494,-0.9622685,-0.95518957,-0.96980966,-0.96423554,-0.97268984
,-0.99719965,-0.96755586,-0.98133286,-0.98881564,-1.00597749,-1.01045219
,-1.01357536,-1.01353862,-1.01374422,-1.00638188,-1.01041394,-1.00456928
,-1.00872286,-1.01105833,-1.00309731,-1.01978652,-1.02076538,-1.01711822
,-1.02101166,-1.01993217,-1.02095412,-1.02061046]
,[-0.37873361,-0.50191889,-0.61930699,-0.67227997,-0.6712852,-0.73166617
,-0.81604656,-0.80153881,-0.83951726,-0.89690957,-0.88886017,-0.93017155
,-0.94277201,-0.91076509,-0.95829946,-0.96812222,-0.95051509,-0.9682914
,-0.99966537,-1.00367415,-0.98290558,-0.9948877,-0.99943322,-0.98618493
,-1.0041457,-1.00238182,-1.00299582,-1.00822433,-1.00988874,-1.01148326
,-1.00919929,-1.01672047,-1.01435724,-1.01645003,-1.01719813,-1.02102517
,-1.02359927,-1.02359927,-1.02359927,-1.02359927]
,[-0.3551861,-0.44409349,-0.51860418,-0.65584073,-0.74147071,-0.69133915
,-0.79577045,-0.84056283,-0.8344514,-0.85244999,-0.89153049,-0.86258786
,-0.91413318,-0.92019161,-0.93790122,-0.934736,-0.96120001,-0.95012408
,-0.96395944,-0.95314274,-0.97900008,-0.97999562,-0.9883966,-1.00037053
,-0.99231226,-0.98142214,-0.99764982,-1.01333751,-1.00638891,-1.00320933
,-1.00987391,-1.01778246,-1.01132729,-1.01718111,-1.01340522,-1.01676031
,-1.02359927,-1.02359927,-1.02016618,-1.01635852]
,[-0.34603189,-0.47178032,-0.48297592,-0.66098987,-0.64250215,-0.65547474
,-0.71777539,-0.79942691,-0.85263722,-0.82799915,-0.8426335,-0.85662485
,-0.88561116,-0.91909595,-0.91183459,-0.95224335,-0.96661398,-0.93396158
,-0.93243082,-0.95595254,-0.97781859,-0.9801914,-0.97715191,-1.00419435
,-0.99726014,-0.9818515,-0.98286832,-0.99502878,-1.00524868,-1.00783987
,-1.01307518,-1.01419021,-1.02359927,-1.01003683,-1.01699163,-1.01774736
,-1.01975358,-1.01763031,-1.01944082,-1.01675717]
,[-0.30302096,-0.42661431,-0.50211089,-0.56267484,-0.61303049,-0.66134602
,-0.69016513,-0.76242577,-0.79248834,-0.84943623,-0.83239344,-0.85136913
,-0.85741428,-0.8893181,-0.89415973,-0.92098567,-0.94322178,-0.93659956
,-0.95833581,-0.96105607,-0.94505102,-0.98606154,-0.96533117,-0.96457738
,-0.98255173,-0.98433923,-0.98882013,-0.99085336,-1.00134066,-1.00695884
,-1.00577315,-1.01385228,-1.00396994,-1.018012,-1.01770523,-1.01004032
,-1.01830085,-1.00890252,-1.00989695,-1.01435331]
,[-0.23006928,-0.40525834,-0.5137957,-0.50482156,-0.59401004,-0.64458775
,-0.6313494,-0.73995876,-0.76461104,-0.77535224,-0.78158188,-0.82912897
,-0.89180116,-0.84027976,-0.90128783,-0.88002254,-0.91465006,-0.92039543
,-0.92878102,-0.92415988,-0.94164471,-0.92940267,-0.97223663,-0.95164918
,-0.97138696,-0.96660395,-0.98425378,-0.97693765,-0.97767479,-1.00345549
,-0.99907087,-0.99820658,-1.00703492,-0.99965352,-1.00204803,-1.01325425
,-1.01093754,-1.00024826,-1.01425302,-1.01058368]]

if len(epsilons) != len(test_losses):
    print(len(epsilons), len(test_losses))
    raise Exception("should be the same, check epsilons")
TRAIN_SIZE = len(test_losses[0])
train_sizes = np.arange(1, TRAIN_SIZE+1)

plt.title("Linreg 10D Gaussian with OPT")
plt.xlabel("Size of Training Dataset")
plt.ylabel("Test Loss")
for i in range(len(epsilons)):
    print('eps:', epsilons[i])
    ysmoothed = gaussian_filter1d(test_losses[i], sigma=1)
    plt.plot(train_sizes, ysmoothed, label=f"Ɛ = {epsilons[i]}")
plt.legend(loc="right")
plt.savefig(f"linreg_gaussian_opt_10d.png")
plt.clf()

"""
# 1
plt.title("Linear Regression Gaussian")
plt.xlabel("Size of Training Dataset")
plt.ylabel("Test Loss")
for i in [1,2,3]: # range(len(epsilons)):
    print('eps:', epsilons[i])
    plt.plot(train_sizes, test_losses[i], label=f"Ɛ = {epsilons[i]}")
plt.legend(loc="best")
plt.savefig(f"linreg_gaussian_fgsm_1d_weak.png")
plt.clf()

# 2
for i in [13, 14, 15, 16]:
    print('eps:', epsilons[i])
    plt.plot(train_sizes, test_losses[i], label=f"Ɛ = {epsilons[i]}")
plt.legend(loc="best")
plt.savefig(f"linreg_gaussian_fgsm_1d_strong.png")
"""
