import numpy as np
import matplotlib.pyplot as plt
from scipy.ndimage.filters import gaussian_filter1d
epsilons = [0, 0.1, 0.3, 0.5, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0, 1.3, 1.5, 1.7, 2.0] # linear loss
# epsilons = [0, 0.1, 0.3, 0.5, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0, 1.3, 1.5, 1.7, 2.0] # gaussian
# epsilons = [0, 1., 3., 4., 7., 8., 10., 12.] # poisson

test_losses= [[-0.44134107,-0.71627485,-0.64392385,-0.75968544,-0.78862584,-0.78139074
,-0.91885763,-0.91885763,-0.97673843,-0.99844373,-0.99844373,-0.99844373
,-1.03461922,-1.02014903,-1.02738413,-1.03461922,-1.04185432,-1.03461922
,-1.05632452,-1.07079472,-1.05632452,-1.05632452,-1.05632452,-1.07802982
,-1.08526492,-1.07802982,-1.07079472,-1.08526492,-1.07802982,-1.08526492
,-1.07802982,-1.08526492,-1.07802982,-1.08526492,-1.07802982,-1.08526492
,-1.08526492,-1.08526492,-1.08526492,-1.08526492]
,[-0.48200346,-0.60173322,-0.76762301,-0.7663352,-0.78136717,-0.92356035
,-0.89060079,-0.89712196,-0.9039518,-0.9595985,-0.99817874,-0.98687117
,-1.04937074,-0.97991324,-1.03434105,-1.0343085,-1.04138007,-1.03022463
,-1.06055209,-1.04161734,-1.06722502,-1.06033722,-1.06750351,-1.06015292
,-1.07811885,-1.06405703,-1.07044637,-1.06378412,-1.07818709,-1.07424556
,-1.08132487,-1.07434678,-1.07420778,-1.06359897,-1.07811922,-1.08154579
,-1.08526492,-1.0817379,-1.08526492,-1.08526492]
,[-0.39831835,-0.5909744,-0.73478674,-0.72509669,-0.84452375,-0.74688191
,-0.88961869,-0.91203191,-0.90704379,-0.91529409,-0.92258232,-0.9727985
,-0.99314344,-0.97319667,-1.00747031,-1.00310451,-0.94578817,-0.97477365
,-1.02485602,-0.98063789,-1.04753382,-1.03531811,-1.02698872,-1.03897694
,-1.0568836,-1.06399368,-1.03300543,-1.0667023,-1.04701298,-1.03821541
,-1.06162998,-1.06545031,-1.06139653,-1.053935,-1.06808658,-1.07087694
,-1.06743609,-1.05378761,-1.06746458,-1.07076795]
,[-0.45194918,-0.57164204,-0.58719467,-0.68417462,-0.73780168,-0.73088211
,-0.75344188,-0.83259677,-0.83769745,-0.86431327,-0.83206403,-0.83264917
,-0.91471979,-0.85214002,-0.90829789,-0.93723906,-0.90136426,-0.92464183
,-0.94656199,-0.9247349,-0.97910902,-0.96734511,-0.95238567,-0.9853249
,-0.95919521,-0.95440571,-0.99493007,-0.98489624,-1.01964202,-1.00473778
,-1.00255958,-0.99347509,-1.0234885,-1.00395238,-0.98441717,-1.02745051
,-1.01553768,-1.00780161,-0.99659357,-1.05100157]
,[-0.43779092,-0.49682133,-0.63156554,-0.59910723,-0.69351943,-0.73802864
,-0.80476287,-0.81817359,-0.76576597,-0.80727669,-0.76296668,-0.88815446
,-0.83830155,-0.79279134,-0.86536585,-0.84917337,-0.87017244,-0.89494762
,-0.89408614,-0.92825886,-0.843592,-0.94604188,-0.87805502,-0.8918693
,-0.92761895,-0.93681128,-0.95939822,-0.92969451,-0.93820515,-0.95521839
,-0.89443918,-0.97445363,-0.96546379,-0.95410313,-0.9318987,-0.90404596
,-0.99740492,-0.98589967,-0.95048108,-0.96070655]
,[-0.47734446,-0.54569784,-0.61643832,-0.62734381,-0.65300327,-0.70881988
,-0.71672528,-0.73791255,-0.72801627,-0.80313007,-0.83288784,-0.79262829
,-0.78065177,-0.8153762,-0.85513076,-0.81920367,-0.90824266,-0.83328768
,-0.85327217,-0.87039014,-0.8136762,-0.83541549,-0.87948015,-0.83831289
,-0.85201271,-0.87274506,-0.86397809,-0.87118898,-0.90055843,-0.87577652
,-0.93248645,-0.90674865,-0.92860574,-0.88605222,-0.91366869,-0.93648466
,-0.93429121,-0.92690263,-0.92879103,-0.92319047]
,[-0.40565395,-0.53645666,-0.58346563,-0.63959563,-0.71654186,-0.68939749
,-0.73257254,-0.72860169,-0.70627234,-0.73941015,-0.74019863,-0.72602107
,-0.78605126,-0.77901103,-0.78247644,-0.77955395,-0.78974666,-0.80034955
,-0.79580012,-0.83327834,-0.86066794,-0.84376528,-0.83364043,-0.84004203
,-0.82788581,-0.86799527,-0.85244963,-0.86754379,-0.85967902,-0.82800037
,-0.85711121,-0.87805137,-0.8789442,-0.88527151,-0.90041888,-0.87048388
,-0.91955693,-0.90770753,-0.8970814,-0.89634276]
,[-0.34843786,-0.45449694,-0.55665625,-0.62979296,-0.71001215,-0.65535133
,-0.65671776,-0.63225441,-0.71671194,-0.73557819,-0.75331373,-0.72030651
,-0.73820579,-0.7238818,-0.73438485,-0.75283291,-0.80571382,-0.75439447
,-0.75218065,-0.7472991,-0.76333892,-0.77688551,-0.831768,-0.75782218
,-0.81505895,-0.82546441,-0.80705121,-0.85387108,-0.76992257,-0.81024976
,-0.87065362,-0.89043652,-0.85706073,-0.83862512,-0.79650733,-0.8678781
,-0.87345838,-0.81965039,-0.85176137,-0.84797256]
,[-0.37159117,-0.54835262,-0.56664733,-0.5898465,-0.6099071,-0.59648955
,-0.70291002,-0.66450469,-0.64986398,-0.73741312,-0.64080496,-0.64046725
,-0.71823835,-0.70040263,-0.71435009,-0.67158115,-0.73808448,-0.7493843
,-0.73715407,-0.79119838,-0.72804407,-0.74022617,-0.7779268,-0.7450731
,-0.69940463,-0.77951936,-0.75443981,-0.74387738,-0.78619657,-0.75123904
,-0.79016086,-0.81517833,-0.77029482,-0.81247991,-0.80078206,-0.77072816
,-0.81907078,-0.79333894,-0.82359538,-0.81906218]
,[-0.37787789,-0.52734088,-0.45944586,-0.5467189,-0.63322083,-0.52729134
,-0.63672461,-0.62917525,-0.67911258,-0.67492157,-0.59514513,-0.62010773
,-0.66610661,-0.71012284,-0.70852564,-0.70443842,-0.67466816,-0.71922471
,-0.70540943,-0.6788123,-0.67483272,-0.77564902,-0.70994001,-0.71952344
,-0.68112354,-0.75928856,-0.71901222,-0.72791751,-0.69571307,-0.76242114
,-0.70783197,-0.75127614,-0.78128501,-0.73085535,-0.75094157,-0.7821933
,-0.7507319,-0.77957478,-0.76747363,-0.77382351]
,[-0.33718282,-0.45274653,-0.58690336,-0.53677679,-0.53374205,-0.57221885
,-0.6659631,-0.65296707,-0.60176525,-0.57442244,-0.65228054,-0.55465685
,-0.60450712,-0.62410447,-0.6572439,-0.65906953,-0.64603335,-0.70698816
,-0.64194382,-0.66242883,-0.60922254,-0.66146035,-0.64015487,-0.62715647
,-0.6962834,-0.69934184,-0.67473396,-0.71094876,-0.67047475,-0.70829681
,-0.66497793,-0.67301375,-0.71224249,-0.76080872,-0.63953135,-0.64042373
,-0.69431234,-0.65781439,-0.70632075,-0.73071663]
,[-0.34052906,-0.39802672,-0.53644038,-0.50522339,-0.48826845,-0.56620985
,-0.55602028,-0.59834654,-0.61257869,-0.54178811,-0.56688477,-0.53442886
,-0.52974313,-0.59194691,-0.59988425,-0.62159923,-0.63751594,-0.58450822
,-0.58962909,-0.57285467,-0.62398431,-0.62341308,-0.65022337,-0.55590914
,-0.62332967,-0.67767698,-0.65033014,-0.64027047,-0.62584686,-0.61941066
,-0.60352553,-0.54505008,-0.66772294,-0.60325796,-0.61052585,-0.59348014
,-0.63522052,-0.65513676,-0.63373842,-0.58084155]
,[-0.39581365,-0.44315355,-0.54642555,-0.45484877,-0.48782979,-0.53679814
,-0.57980285,-0.55021821,-0.50667051,-0.58024602,-0.53995734,-0.53178015
,-0.55426379,-0.59117155,-0.55550155,-0.54736658,-0.58998897,-0.5521152
,-0.5697233,-0.61551219,-0.54141391,-0.55938214,-0.57822981,-0.60324536
,-0.57967209,-0.55434986,-0.59149394,-0.57531341,-0.47872436,-0.5197425
,-0.58877406,-0.55115702,-0.51599885,-0.55470145,-0.59824842,-0.4953002
,-0.58495344,-0.52075159,-0.60064185,-0.55821068]
,[-0.35462632,-0.41120927,-0.42399629,-0.4365971,-0.41409343,-0.39208781
,-0.37307403,-0.3779492,-0.38750631,-0.27520612,-0.39285534,-0.34920162
,-0.30882885,-0.36040193,-0.31771314,-0.29723744,-0.33866316,-0.26150215
,-0.24717527,-0.30256024,-0.31801872,-0.31012476,-0.26842276,-0.27522566
,-0.28578238,-0.22906513,-0.20594956,-0.23672681,-0.26589839,-0.22552853
,-0.23060537,-0.23756606,-0.23419945,-0.18020542,-0.24451769,-0.2161258
,-0.22693718,-0.21794407,-0.19722203,-0.21078987]
,[-0.29514307,-0.41935412,-0.33726495,-0.37074801,-0.31161257,-0.31548114
,-0.30215216,-0.28470897,-0.21639313,-0.20753904,-0.24524621,-0.2180756
,-0.22922136,-0.1920821,-0.16296269,-0.15032725,-0.18405728,-0.17673258
,-0.13636368,-0.18537225,-0.18150912,-0.15109191,-0.117278,-0.12127514
,-0.13178824,-0.11364185,-0.13726662,-0.10883283,-0.10724157,-0.11121805
,-0.10623419,-0.07981522,-0.11528313,-0.097525,-0.07407075,-0.08388614
,-0.09856759,-0.06346004,-0.07611492,-0.10613276]
,[-0.29966219,-0.33701878,-0.28837604,-0.33410567,-0.26544873,-0.24258527
,-0.24960517,-0.1856994,-0.20340438,-0.1396679,-0.17360075,-0.15531948
,-0.12925035,-0.10438896,-0.11599494,-0.11193334,-0.10198781,-0.12101398
,-0.05791456,-0.09271296,-0.06215961,-0.06766773,-0.0598324,-0.08249384
,-0.05202733,-0.0462279,-0.04403551,-0.0537742,-0.05824415,-0.03475776
,-0.03888456,-0.04148096,-0.02576862,-0.03425077,-0.03668043,-0.03039439
,-0.02520462,-0.03326314,-0.02119345,-0.02699565]
,[-0.21024419,-0.24824006,-0.25897471,-0.19354889,-0.13694201,-0.1207021
,-0.10079071,-0.09521189,-0.08071614,-0.07353486,-0.06525218,-0.05133721
,-0.04318966,-0.06425001,-0.06263901,-0.04885979,-0.03247755,-0.03835975
,-0.03603457,-0.01534827,-0.01030883,-0.01774924,-0.02055059,-0.0126513
,-0.02182839,-0.0226532,-0.01951659,-0.00974907,-0.01524116,-0.00877332
,-0.0100318,-0.01404202,-0.01930338,-0.01044918,-0.01040857,-0.00426841
,-0.00563057,-0.01328671,-0.00360566,-0.0091845]]


if len(epsilons) != len(test_losses):
    raise Exception("should be the same, check epsilons")
TRAIN_SIZE = len(test_losses[0])
train_sizes = np.arange(1, TRAIN_SIZE+1)

plt.title("Linear 1D with PGD")
plt.xlabel("Size of Training Dataset")
plt.ylabel("Test Loss")
for i in range(len(epsilons)): # range(len(epsilons)):
    print('eps:', epsilons[i])
    ysmoothed = gaussian_filter1d(test_losses[i], sigma=2)
    plt.plot(train_sizes, ysmoothed, label=f"Ɛ = {epsilons[i]}")
plt.legend(loc="right")
plt.savefig(f"linear_pgd_1d_all.png")
plt.clf()

"""
# 1
plt.title("Linear Regression Gaussian")
plt.xlabel("Size of Training Dataset")
plt.ylabel("Test Loss")
for i in [1,2,3]: # range(len(epsilons)):
    print('eps:', epsilons[i])
    plt.plot(train_sizes, test_losses[i], label=f"Ɛ = {epsilons[i]}")
plt.legend(loc="best")
plt.savefig(f"linreg_gaussian_fgsm_1d_weak.png")
plt.clf()

# 2
for i in [13, 14, 15, 16]:
    print('eps:', epsilons[i])
    plt.plot(train_sizes, test_losses[i], label=f"Ɛ = {epsilons[i]}")
plt.legend(loc="best")
plt.savefig(f"linreg_gaussian_fgsm_1d_strong.png")
"""
