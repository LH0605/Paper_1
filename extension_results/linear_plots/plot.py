import numpy as np
import matplotlib.pyplot as plt
from scipy.ndimage.filters import gaussian_filter1d
# del index (4,5,6,7,9,11,15)
epsilons = [0, 0.1, 0.3, 0.5, 0.8, 0.9, 1.0, 1.3, 1.5, 2.0] # linear loss
# epsilons = [0, 0.1, 0.3, 0.5, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0, 1.3, 1.5, 1.7, 2.0] # linear loss
# epsilons = [0, 1., 3., 4., 6., 8., 10., 12.] # poisson
# epsilons = [0, 1., 3., 4., 7., 8., 10., 12.] # poisson alt
# epsilons = [0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.5, 2.0, 2.5, 3.0] # gaussian
# epsilons = [0, 0.1, 0.2, 0.3, 0.7, 0.8, 0.9, 1.0, 1.5, 2.0] # gaussian reduced

test_losses = [[-0.79240872,-1.16317704,-1.31712474,-1.33360931,-1.62997319,-1.85699025
,-1.84718579,-1.86482612,-1.97530082,-2.01996159,-1.92677637,-2.10497891
,-2.12730929,-2.1882304,-2.1641342,-2.16354559,-2.20272492,-2.17862871
,-2.19430045,-2.20997218,-2.23896121,-2.24013843,-2.21721944,-2.22505531
,-2.23171396,-2.24072704,-2.24738569,-2.2479743,-2.26246881,-2.25522156
,-2.25522156,-2.25522156,-2.26246881,-2.25522156,-2.26246881,-2.26246881
,-2.24738569,-2.26246881,-2.25463295,-2.25522156]
,[-0.86827968,-1.19121964,-1.39435891,-1.467468,-1.70613,-1.71394677
,-1.85198442,-1.88056714,-1.93845295,-2.06418483,-2.03523383,-2.05315459
,-2.14241885,-2.15000872,-2.12178012,-2.15664241,-2.16398054,-2.14847222
,-2.18333632,-2.21554966,-2.23289408,-2.22121036,-2.22098786,-2.24128379
,-2.2309343,-2.23986192,-2.23570474,-2.25434075,-2.24653973,-2.22958888
,-2.22901895,-2.2474503,-2.2605649,-2.25359736,-2.25169743,-2.26246881
,-2.26246881,-2.26246881,-2.25463295,-2.26246881]
,[-0.86071706,-1.13355284,-1.35903937,-1.5526786,-1.63182395,-1.73477609
,-1.83070277,-1.90936574,-1.99363862,-1.9872273,-2.04006621,-2.00726914
,-2.07684628,-2.14272923,-2.13262687,-2.15595191,-2.17301541,-2.14712259
,-2.15358137,-2.19549482,-2.17906585,-2.22944001,-2.20972854,-2.2300203
,-2.23781425,-2.22096598,-2.23365736,-2.24660773,-2.2466841,-2.23526948
,-2.25221948,-2.22674906,-2.22652452,-2.24944123,-2.24777883,-2.23508281
,-2.25452012,-2.25807375,-2.25873545,-2.25069783]
,[-1.03126772,-1.1279385,-1.30981623,-1.49839617,-1.54333717,-1.70925759
,-1.7640891,-1.82089531,-1.94332403,-1.92331102,-2.0040224,-2.00286645
,-2.07822859,-2.08787583,-2.10584954,-2.11286383,-2.1807191,-2.12876269
,-2.17771332,-2.15935934,-2.17700593,-2.17577363,-2.20860688,-2.19020904
,-2.20549831,-2.24552932,-2.2279141,-2.22671051,-2.20880401,-2.24208571
,-2.24138739,-2.2462186,-2.23332136,-2.23630309,-2.25054204,-2.25909632
,-2.23990461,-2.25881573,-2.26124189,-2.2617227,]
,[-0.82761793,-1.12000284,-1.35730464,-1.42052312,-1.57415708,-1.75074275
,-1.82909225,-1.86353011,-1.98184171,-1.95860708,-2.00100948,-1.9587022
,-2.04287175,-2.09265325,-2.11476825,-2.10829453,-2.09156703,-2.11906404
,-2.16634456,-2.15980808,-2.18073395,-2.15956703,-2.21999192,-2.19779481
,-2.21625676,-2.19177332,-2.2224149,-2.21200247,-2.2378673,-2.21777059
,-2.22686722,-2.22940911,-2.23969033,-2.24028328,-2.2480352,-2.25665974
,-2.25288824,-2.23751092,-2.25984151,-2.26050436]
,[-0.81701897,-1.11049556,-1.35609261,-1.49172622,-1.58894996,-1.67606641
,-1.73158708,-1.76841677,-1.88612056,-1.91307978,-1.95366124,-2.01534145
,-2.00637514,-1.97960135,-2.11943276,-2.12508139,-2.07030169,-2.14696877
,-2.14018833,-2.15012887,-2.15922601,-2.20527621,-2.18538143,-2.17238447
,-2.20850431,-2.2351892,-2.22185368,-2.24182293,-2.22571431,-2.23852151
,-2.23141723,-2.25005176,-2.23186144,-2.25289063,-2.23010047,-2.24220862
,-2.25078255,-2.23016299,-2.24671939,-2.26061447]
,[-0.87032774,-1.07270247,-1.36013668,-1.47038175,-1.58331421,-1.64208083
,-1.71272394,-1.86887651,-1.89830022,-1.91257783,-1.95695642,-2.03626531
,-1.95768974,-2.07506074,-2.10694891,-2.06695838,-2.09778734,-2.1363835
,-2.11975528,-2.14210757,-2.19209204,-2.18630611,-2.18864105,-2.18429309
,-2.18457541,-2.20916475,-2.23020212,-2.21359289,-2.22260705,-2.23672838
,-2.22893237,-2.22468934,-2.23694304,-2.24448687,-2.24561053,-2.21840022
,-2.22630919,-2.23013075,-2.23374788,-2.2498671,]
,[-0.79898609,-1.04810701,-1.27005262,-1.43045371,-1.56811049,-1.59873595
,-1.70211512,-1.82742879,-1.82908493,-1.89828838,-1.96706117,-2.0249744
,-2.03590581,-2.02454663,-2.04147834,-2.06826442,-2.08997869,-2.06933376
,-2.10830994,-2.08299962,-2.20048069,-2.1688579,-2.11307717,-2.22190026
,-2.21546408,-2.19568038,-2.19997042,-2.18233338,-2.20129749,-2.2080798
,-2.20203032,-2.24207303,-2.21453915,-2.21834045,-2.24247624,-2.23035681
,-2.25744215,-2.26008929,-2.23162194,-2.24465345]
,[-0.81407943,-1.06470191,-1.24349517,-1.53784863,-1.5170863,-1.65346585
,-1.7319353,-1.76226979,-1.81291159,-1.94350297,-1.92675196,-1.98082977
,-2.00924856,-2.01453077,-2.03205645,-2.03438191,-2.04751814,-2.08524329
,-2.10107086,-2.16979271,-2.18284575,-2.1630932,-2.19247139,-2.19120356
,-2.16461105,-2.19840287,-2.18715633,-2.2068709,-2.16082149,-2.21422402
,-2.21496908,-2.20529718,-2.24329597,-2.21127645,-2.20577181,-2.21305783
,-2.23948903,-2.20558927,-2.23833411,-2.23171692]
,[-0.81316286,-1.07711779,-1.32236373,-1.37291914,-1.53988699,-1.63307492
,-1.67764197,-1.78403034,-1.86046411,-1.85315819,-1.91920295,-2.00096525
,-1.98297469,-2.04620846,-2.01811093,-2.05349652,-2.06433854,-2.07339259
,-2.10005457,-2.15016994,-2.14966974,-2.13602592,-2.17778606,-2.13391616
,-2.17313259,-2.19721663,-2.17827854,-2.21097423,-2.16528041,-2.24743145
,-2.16689037,-2.18144008,-2.19672571,-2.17834854,-2.19225284,-2.24443824
,-2.21733436,-2.23118506,-2.21890318,-2.24598538]
,[-0.86679902,-0.97717091,-1.29503286,-1.44909807,-1.47814222,-1.61369146
,-1.73501125,-1.76334833,-1.76780427,-1.86847745,-1.96176489,-1.99729932
,-1.99544987,-2.02488292,-1.96978926,-2.02948754,-2.06325511,-2.07803417
,-2.10378599,-2.15282791,-2.12063229,-2.12618251,-2.13882024,-2.15675418
,-2.16941468,-2.14424988,-2.17962992,-2.14403857,-2.18260621,-2.18379167
,-2.1691714,-2.21010371,-2.13168936,-2.22347716,-2.24246177,-2.19099994
,-2.21314495,-2.22823619,-2.21100231,-2.20540421]
,[-0.79744462,-1.1368114,-1.26065524,-1.31298668,-1.54382684,-1.64867213
,-1.67928232,-1.73642683,-1.81553833,-1.80053522,-1.88186412,-1.9402814
,-1.99722624,-2.0010592,-1.87318879,-1.98110618,-2.03974112,-2.12712584
,-2.10973348,-2.08914832,-2.09741771,-2.16810445,-2.13733711,-2.13660227
,-2.13890102,-2.15555295,-2.17376028,-2.17970588,-2.16275634,-2.16546565
,-2.13674056,-2.15359082,-2.1943796,-2.162411,-2.16948459,-2.1568597
,-2.15919576,-2.17829014,-2.16896332,-2.19527424]
,[-0.81454319,-0.98530347,-1.2546649,-1.39542369,-1.54945007,-1.63304733
,-1.67754737,-1.77305778,-1.78870198,-1.76088069,-1.92842732,-1.88155529
,-1.92695498,-1.93814443,-2.03870254,-1.970443,-2.08908126,-2.02108061
,-2.09287111,-2.09277353,-2.14458175,-2.11427251,-2.1801861,-2.0904996
,-2.10391006,-2.14042631,-2.14732803,-2.16645552,-2.11881171,-2.1679196
,-2.1657943,-2.15119923,-2.17247316,-2.11812167,-2.17502357,-2.17229307
,-2.08895015,-2.12868547,-2.1580527,-2.12723636]
,[-0.68507539,-0.89721689,-1.16661541,-1.35571128,-1.47240107,-1.44210035
,-1.52348522,-1.57684019,-1.74068212,-1.64849312,-1.71241194,-1.85406352
,-1.81156882,-1.91416821,-1.9170236,-1.85316792,-1.88274475,-1.93453531
,-1.93080242,-1.96626497,-1.96665117,-1.93459199,-1.95969968,-1.9931748
,-1.92928132,-1.90538005,-1.97751834,-1.91828639,-1.91940924,-1.93146037
,-1.98513253,-1.93463245,-2.01727767,-2.0688748,-1.93633367,-1.8980323
,-1.98260261,-2.01401942,-1.93371086,-2.03665018]
,[-0.69532003,-0.9391247,-1.10943521,-1.29896206,-1.3287834,-1.42676875
,-1.47898764,-1.52269315,-1.57316082,-1.66813308,-1.65475922,-1.73586745
,-1.7575072,-1.77362475,-1.74038265,-1.76236069,-1.80232786,-1.79764248
,-1.69825507,-1.7389429,-1.82586428,-1.70930225,-1.78819576,-1.74481171
,-1.80400479,-1.68260065,-1.71110697,-1.70209705,-1.74914682,-1.76339162
,-1.69538741,-1.88164718,-1.74577059,-1.68667542,-1.772845,-1.74919938
,-1.67869692,-1.76395934,-1.72205984,-1.77689436]
,[-0.72357176,-0.86258191,-1.00369248,-1.26553106,-1.24902029,-1.38141778
,-1.43796479,-1.45539485,-1.52653391,-1.5318724,-1.56719042,-1.6756368
,-1.50437264,-1.58296948,-1.70450555,-1.62074128,-1.53712874,-1.55090722
,-1.55033104,-1.62532377,-1.59651244,-1.6020871,-1.5106627,-1.4667116
,-1.50396721,-1.58484726,-1.55922232,-1.48827661,-1.50043776,-1.48816297
,-1.51621882,-1.47965939,-1.47938824,-1.47438381,-1.4731395,-1.37278839
,-1.57168208,-1.46672013,-1.46291263,-1.42323017]
,[-0.62634178,-0.82036702,-1.07350017,-1.07195201,-1.02388206,-1.12926596
,-1.27228358,-1.27223596,-1.41082942,-1.35360065,-1.30786766,-1.40294787
,-1.46217266,-1.34137221,-1.29613495,-1.36315157,-1.26739786,-1.21129557
,-1.25093746,-1.13804689,-1.13479768,-1.17618824,-1.25145532,-1.25871285
,-1.16149979,-1.16791954,-1.1829728,-1.1601353,-1.12801522,-1.05562965
,-1.03477547,-1.057813,-1.05213376,-1.12829148,-1.00770925,-0.97916408
,-1.03573187,-1.1515211,-0.98037889,-1.0903676,]]




del(test_losses[4])
del(test_losses[4])
del(test_losses[4])
del(test_losses[4])
del(test_losses[5])
del(test_losses[6])
del(test_losses[9])

if len(epsilons) != len(test_losses):
    print(len(epsilons), len(test_losses))
    raise Exception("should be the same, check epsilons")
TRAIN_SIZE = len(test_losses[0])
train_sizes = np.arange(1, TRAIN_SIZE+1)

plt.title("Linear Loss 5D with FGM+sqrt")
plt.xlabel("Size of Training Dataset")
plt.ylabel("Test Loss")
for i in range(len(epsilons)-1,0,-1):
    print('eps:', epsilons[i])
    ysmoothed = gaussian_filter1d(test_losses[i], sigma=1)
    plt.plot(train_sizes, ysmoothed, label=f"Ɛ = {epsilons[i]}")
plt.legend(loc="right")
plt.savefig(f"../../linear_fgm_sqrt_5d.png")
plt.clf()

"""
# 1
plt.title("Linear Regression Gaussian")
plt.xlabel("Size of Training Dataset")
plt.ylabel("Test Loss")
for i in [1,2,3]: # range(len(epsilons)):
    print('eps:', epsilons[i])
    plt.plot(train_sizes, test_losses[i], label=f"Ɛ = {epsilons[i]}")
plt.legend(loc="best")
plt.savefig(f"linreg_gaussian_fgsm_1d_weak.png")
plt.clf()

# 2
for i in [13, 14, 15, 16]:
    print('eps:', epsilons[i])
    plt.plot(train_sizes, test_losses[i], label=f"Ɛ = {epsilons[i]}")
plt.legend(loc="best")
plt.savefig(f"linreg_gaussian_fgsm_1d_strong.png")
"""
